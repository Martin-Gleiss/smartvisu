{% macro sliderExt(id, txt, item_switch, item_value, pic, color, indicator, min, max, step, orientation, value_display, min_display, max_display) %}
    {% import "quad/widgets/visu.html" as visu %}
    <div id="{{ id }}" data-role="popup" data-overlay-theme="a" class="quad_slider-popup">
        {{ visu.sliderExt(id~'dimmer_ext', txt, item_switch, item_value, pic, color, indicator, min, max, step, orientation, value_display, min_display, max_display) }}
    </div>
{% endmacro %}

{% macro extpopup(id, line1, line2, line3, line4, line5, line6, line7, line8, line9, line10, line11, line12, line13, line14, line15, line16, line17, line18, line19, line20) %}
	{% import "basic.html" as basic %}
	{% set elements = {} %}
    <div id="{{ id }}" data-role="popup" data-overlay-theme="a" class="quad_ext-popup">
    <button data-rel='back' data-icon='delete' data-iconpos='notext' class='ui-btn-right' id='{{id}}_popupClose' onClick='$("#{{ id }}-screen").click()'></button>
    <ul data-role="listview" data-dividertheme="c" class="quad_list">
    {% for linenumber in 1..20 %}
        {% set elements_array = {} %}
        {% set i = 1 %}
        {% if _context['line' ~ linenumber] %}
                <li class="quad_table row_ext-popup line{{linenumber}}">
        {% endif %}
        {% for key,attribs in _context['line' ~ linenumber]  %}
            {% if attribs is not iterable %}
			         {% set attribs = [attribs] %}
			      {% endif %}
            {% for key1,item in attribs  %}
                {% if item == 'switch' or item == 'stateswitch' %}
                    {% set switch_attribs = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="switch popup_column_{{i}}">{{ basic.stateswitch(id~'switch'~key1~item~linenumber, switch_attribs[0], switch_attribs[1], switch_attribs[2], switch_attribs[3], switch_attribs[4], switch_attribs[5], switch_attribs[6]) }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'select' %}
                    {% set select_attribs = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="select popup_column_{{i}}">{{ basic.select(id~'select'~key1~item~linenumber, select_attribs[0], select_attribs[1], select_attribs[2], select_attribs[3], select_attribs[4]|default(''), select_attribs[5]|default('icon1'), select_attribs[6]|default('horizontal')) }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'image' %}
                    {% set icon_attribs = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="icon popup_column_{{i}}">{{ basic.icon(icon_attribs[0], icon_attribs[1], icon_attribs[2]) }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'flip' %}
                    {% set flip_attribs = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="flip popup_column_{{i}}">{{ basic.flip(id~'flip'~key1~item~linenumber, flip_attribs[0], flip_attribs[1], flip_attribs[2], flip_attribs[3], flip_attribs[4], flip_attribs[5]) }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'slider' %}
                    {% set slider_attribs = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="slider popup_column_{{i}}">{{ basic.slider(id~'slider'~key1~item~linenumber, slider_attribs[0], slider_attribs[1], slider_attribs[2], slider_attribs[3], slider_attribs[4], slider_attribs[5], slider_attribs[6], slider_attribs[7], slider_attribs[8]) }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'text' or item == 'symbol' %}
                    {% set text_attribs = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="text popup_column_{{i}}">{{ basic.symbol(id~'text'~key1~item~linenumber, text_attribs[0], text_attribs[1], text_attribs[2], text_attribs[3], text_attribs[4], text_attribs[5], text_attribs[6], text_attribs[7]) }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'print' %}
                    {% set print_attribs = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="print popup_column_{{i}}">{{ basic.print(id~'print'~key1~item~linenumber, print_attribs[0], print_attribs[1], print_attribs[2], print_attribs[3], print_attribs[4]) }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'linetext' %}
                    {% set linetext_attrib = _context['line' ~ linenumber][key+key1+1] %}
                    <div class="linetext popup_column_{{i}}">{{ linetext_attrib|e }}</div>
                    {% set i = i+1 %}
                {% elseif item == 'header' %}
                    <div class="header popup_column_{{i}}">{{ _context['line' ~ linenumber][key+key1+1]|e }}</div>
                    {% set i = i+1 %}
                {% endif %}

            {% endfor %}

        {% endfor %}
         {% if _context['line' ~ linenumber] %}
             </li>
        {% endif %}
    {% endfor %}

    </ul>
    </div>
{% endmacro %}




{% macro locks(id, lock, bwm_lock, force, seq_lock) %}
    {% import "basic.html" as basic %}
	<div id="{{id}}" data-role="popup" data-overlay-theme="a" class="quad_locks-popup" style="text-align:center;">
	<div style="margin:auto;text-align:center;display:inline-block;">
		{% if (lock is not iterable and lock != '') or (lock is iterable and lock[0] != '') %}
		<div style="float:left;" class="quad_list">
			{% if lock is iterable  %}
				{{ basic.stateswitch(id~'_lock', lock[0], 'icon', [0,1], ['secur_open','secur_locked'], '', lock[1]) }}
			{% else %}
				{{ basic.stateswitch(id~'_lock', lock, 'icon', [0,1], ['secur_open','secur_locked']) }}
			{% endif %}
        </div>
        {% endif %}
		{% if (bwm_lock is not iterable and bwm_lock != '') or (bwm_lock is iterable and bwm_lock[0] != '') %}
		<div style="float:left;" class="quad_list">
			{% if bwm_lock is iterable %}
				{{ basic.stateswitch(id~'_bwmlock', bwm_lock[0], 'icon', [0,1], ['message_presence','message_presence_disabled'], '', bwm_lock[1]) }}
			{% elseif bwm_lock != '' %}
				{{ basic.stateswitch(id~'_bwmlock', bwm_lock, 'icon', [0,1], ['message_presence','message_presence_disabled']) }}
			{% endif %}
        </div>
        {% endif %}
		{% if (force is not iterable and force != '') or (force is iterable and force[0] != '') %}
		<div style="float:left;margin-top:-10px;padding-top:3px;" class="quad_list">
			{% if force is iterable  %}
			    {% if force[1] is iterable  %}
			        {% set color = force[1][1] %}
			    {% else %}
				    {% set color = force[1] %}
			    {% endif %}
				{{ basic.select(id~'_force', force[0], 'icon', [0,2,3], ['control_minus','light_light_dim_00','light_light_dim_90'], '', color, 'horizontal') }}
			{% else %}
				{{ basic.select(id~'_force', force, 'icon', [0,2,3], ['control_minus','light_light_dim_00','light_light_dim_90']) }}
			{% endif %}
        </div>
        {% endif %}
		{% if (seq_lock is not iterable and seq_lock != '') or (seq_lock is iterable and seq_lock[0] != '') %}
		<div style="float:left;" class="quad_list">
			{% if seq_lock is iterable  %}
				{{ basic.stateswitch(id~'_seq_lock', seq_lock[0], 'icon', [0,1], ['audio_shuffle', 'audio_shuffle'], '', seq_lock[1]) }}
			{% else %}
				{{ basic.stateswitch(id~'_seq_lock', seq_lock, 'icon', [0,1], ['audio_shuffle', 'audio_shuffle']) }}
			{% endif %}
        </div>
        {% endif %}

  	</div>
  	</div>

{% endmacro %}


{% macro hsv(id, item_value_r, item_value_g, item_value_b, item_switch_ww, item_value_ww, min, max, step, pic, color_on, color_off, indicator, orientation, value_display, min_display, max_display) %}
    {% import "basic.html" as basic %}
    {% import "icon.html" as icon %}
    {% import "quad/widgets/visu.html" as visu %}
	<div id="{{ id }}" data-role="popup" data-overlay-theme="a" class="{{ item_value_ww and item_value_ww  != ' ' ? 'quad_hsvww-popup' : 'quad_hsv-popup' }}">
		<p>Hue, Saturation, Value</p>
	    {{ basic.color(id~'_color_popup', item_value_r, item_value_g, item_value_b, min, max, step, '10', 'slider') }}
	    {% if item_value_ww and item_value_ww  != ' ' %}
	    <div style="margin-top:-15px;">
            {{ visu.sliderExt(id~'ww', 'warm white', item_switch_ww, item_value_ww, [icon.light(), icon.light("","",item_value_ww)], [color_off|default('icon0'), color_off|default('yellow')], indicator|default('blink'), min, max, step, orientation|default('horizontal'), value_display|default('handle'), min_display, max_display) }}
        </div>
	    {% endif %}
	</div>
{% endmacro %}


{% macro rgb(id, txt, item_switch_r, item_value_r, item_switch_g, item_value_g, item_switch_b, item_value_b, item_switch_ww, item_value_ww, min, max, step, pic, color_on, color_off, indicator, orientation, value_display, min_display, max_display) %}
    {% import "quad/widgets/visu.html" as visu %}
    {% import "icon.html" as icon %}
	<div id="{{ id }}" data-role="popup" data-overlay-theme="a" class="{{ item_value_ww and item_value_ww  != ' ' ? 'quad_rgbww-popup' : 'quad_rgb-popup' }}">
        {{ visu.sliderExt(id~'ww', txt~' red', item_switch_r, item_value_r, [icon.light(), icon.light("","",item_value_r)], [color_off|default('icon0'), 'red'], indicator|default('blink'), min, max, step, orientation|default('horizontal'), value_display|default('handle'), min_display, max_display) }}
        {{ visu.sliderExt(id~'ww', txt~' green', item_switch_g, item_value_g, [icon.light(), icon.light("","",item_value_g)], [color_off|default('icon0'), 'green'], indicator|default('blink'), min, max, step, orientation|default('horizontal'), value_display|default('handle'), min_display, max_display) }}
        {{ visu.sliderExt(id~'ww', txt~' blue', item_switch_b, item_value_b, [icon.light(), icon.light("","",item_value_b)], [color_off|default('icon0'), 'blue'], indicator|default('blink'), min, max, step, orientation|default('horizontal'), value_display|default('handle'), min_display, max_display) }}

	    {% if item_value_ww and item_value_ww  != ' ' %}
            {{ visu.sliderExt(id~'ww', txt~' warm white', item_switch_ww, item_value_ww, [icon.light(), icon.light("","",item_value_ww)], [color_off|default('icon0'), 'yellow'], indicator|default('blink'), min, max, step, orientation|default('horizontal'), value_display|default('handle'), min_display, max_display) }}
    {% endif %}
	</div>
{% endmacro %}

{% macro shutter(id, txt, item_move, item_stop, item_pos, item_shift, item_angle, item_saved, value_top, value_bottom, step, mode, background, value_pos_1, value_pos_2) %}
    {% import "device.html" as device %}
	<div id="{{ id }}" data-role="popup" data-overlay-theme="a" class="quad_blind-popup">
            {{ device.shutter(id~'blind', txt, item_move, item_stop, item_pos, item_shift, item_angle, item_saved, value_top, value_bottom, step, mode, background, value_pos_1, value_pos_2) }}
	</div>
{% endmacro %}

{% macro blind(id, txt, item_move, item_stop, item_pos, item_shift, item_angle, min, max, step, mode) %}
    {% import "device.html" as device %}
	<div id="{{ id }}" data-role="popup" data-overlay-theme="a" class="quad_blind-popup">
            {{ device.blind(id~'blind', txt, item_move, item_stop, item_pos, item_shift, item_angle, min, max, step, mode) }}
	</div>
{% endmacro %}

{% macro rtr(id, txt, item_actual, item_set, item_comfort, item_night, item_frost, item_state, item_txt, step, item_offset, supplements, color, indicator) %}
    {% import "device.html" as device %}
	<div id="{{ id }}" data-role="popup" data-overlay-theme="a" class="quad_rtr-popup">
            {{ device.rtr(id~'rtr', txt, item_actual, item_set, item_comfort, item_night, item_frost, item_state, item_txt, step, item_offset, supplements, color, indicator) }}
        </div>
{% endmacro %}

{% macro plot(id, gad, mode, tmin, tmax, ymin, ymax, count, label, color, exposure, axis, zoom, assign, opposite, ycolor, ytype, unit) %}
  {% import "plot.html" as plot %}
        <div id="{{id}}" data-role="popup" data-overlay-theme="a" class="quad_plot-popup">
        <button data-rel='back' data-icon='delete' data-iconpos='notext' class='ui-btn-right' id='{{id}}_popupClose' onClick='$("#{{ id }}-screen").click()'></button>
            {{ plot.period(id~'plot_popup', gad, mode, tmin, tmax, ymin, ymax, count, label, color, exposure, axis, zoom, assign, opposite, ycolor, ytype, unit) }}
        </div>
{% endmacro %}

{% macro cover(id, src, defCoverArtUrl) %}
        <div id="{{id}}" data-role="popup" data-overlay-theme="a" class="quad_cover-popup">
            <img class="coverbig" id="{{ uid(page, id) }}" data-widget="visu.cover" data-item="{{ src }}" src="{{ defCoverArtUrl }}"  onerror="javascript:this.src='{{ defCoverArtUrl }}'"/>
        </div>
{% endmacro %}
