/**
* -----------------------------------------------------------------------------
* @package     smartVISU
* @author      Martin Gleiss, Alexander Schwithal, Stefan Widmer
* @copyright   2012 - 2016
* @license     GPL [http://www.gnu.de]
* -----------------------------------------------------------------------------
*/


{% extends "system.html" %}

{% import "forms.html" as forms %}

{% block content %}

	/** related JavaScript part located in lib/base/base.js */

	<h1>Configuration</h1>

	{%
	set sources = {
		'global': lang('configuration_page', 'globaltab', 'label'),
		'pages': lang('configuration_page', 'pagestab', 'label') ~ " '" ~ config_pages ~ "'",
		'cookie': lang('configuration_page', 'cookietab', 'label'),
	}
	%}

	<div data-role="tabs" id="config_source">
		<div data-role="navbar">
			<ul>
		    {% for source, title in sources %}
					<li data-source="{{ source }}"><a href="#config_tab_{{ source }}" data-ajax="false"{{ loop.first ? 'class="ui-btn-active"'|raw }}>{{ title }}</a></li>
		    {% endfor %}
			</ul>
		</div>

/**
		<div id="config_tab_global">
			<h2>Global options (stored in './config.ini')</h2>
		</div>
		<div id="config_tab_pages">
			<h2>Options for current pages '{{ config_pages }}' (stored in './pages/{{ config_pages }}/config.ini')</h2>
      {{ basic.symbol('','','','jquery_info.svg') }}<i>Click label to override specific option, click again to deactive overriding</i>
		</div>
		<div id="config_tab_cookie">
			<h2><i>Options stored on client (as cookie)</i></h2>
      {{ basic.symbol('','','','jquery_info.svg') }}<i>Click label to override specific option, click again to deactive overriding</i>
		</div>
	</div>
*/

	{% for source, title in sources %}
		{% set values = read_config(source) %}

		<div id="config_tab_{{ source }}">
			<h2>{{ lang('configuration_page', source ~ 'tab', 'hint') }}</h2>
			<form>
				<fieldset>

					<div class="block">
						<div class="set-2" data-role="collapsible-set" data-content-theme="a" data-mini="true">
							<div class="ui-bar-c ui-corner-top ui-collapsible-caption">
								<h3 class="ui-collapsible-heading">{{ lang('configuration_page', 'userinterface', 'label') }}</h3>
							</div>
							<div data-role="collapsible" data-collapsed="false" data-theme="c" data-content-theme="a">
								<h3>{{ lang('configuration_page', 'interface', 'label') }}</h3>
								{{ forms.config_select(source, values, 'pages', dir('pages', '^(?!base|apps)(.+?)') ) }}
								{{ forms.config_select(source, values, 'design', dir('designs', '(.+?).css')) }}
								{{ forms.config_flip(source, values, 'cache', '<button type="button" data-theme="a" data-icon="delete" data-inline="true" id="clear_cache" class="ui-micro"' ~ (not values['cache'] is defined ? ' disabled="disabled"'|raw) ~ '>' ~ lang('configuration_page', 'cache', 'clearbutton') ~'</button>') }}
								{{ forms.config_flip(source, values, 'animation') }}
							</div>
							<div data-role="collapsible" data-collapsed="true" data-theme="c" data-content-theme="a" >
								<h3>{{ lang('configuration_page', 'content', 'label') }}</h3>
								{{ forms.config_input(source, values, 'title') }}
								{{ forms.config_select(source, values, 'lang', dir('lang', '^(.*?)\.ini$') ) }}
								{{ forms.config_select(source, values, 'timesource', [{"name": "client", "label": "Client"}, {"name": "server", "label": "Server"}] ) }}
							</div>
						</div>
					</div>

					<div class="block">
						<div class="set-1" data-role="collapsible-set" data-mini="true">
							<div class="ui-bar-c ui-corner-top ui-collapsible-caption">
								<h3 class="ui-collapsible-heading">{{ lang('configuration_page', 'backend', 'label') }}</h3>
							</div>
							<div data-role="collapsible" data-collapsed="false" data-theme="c" data-content-theme="a">
								<h3>{{ lang('configuration_page', 'ioconnection', 'label') }}</h3>
								{{ forms.config_select(source, values, 'driver', dir('driver', '^io_(.+?).js') ) }}
								{{ forms.config_input(source, values, 'driver_address', 'wide') }}
								{{ forms.config_input(source, values, 'driver_port', 'wide') }}
								{{ forms.config_flip(source, values, 'driver_realtime') }}
								{{ forms.config_flip(source, values, 'driver_autoreconnect') }}
							</div>
						</div>
					</div>

					<div class="block">
						<div class="set-3" data-role="collapsible-set" data-content-theme="a" data-mini="true">
							<div class="ui-bar-c ui-corner-top ui-collapsible-caption">
								<h3 class="ui-collapsible-heading">{{ lang('configuration_page', 'dataservices', 'label') }}</h3>
							</div>
							<div data-role="collapsible" data-collapsed="false" data-theme="c" data-content-theme="a">
								<h3>{{ lang('configuration_page', 'weather', 'label') }}</h3>
								{{ forms.config_select(source, values, 'weather_service', dir('lib/weather/service', '(.+?).php') ) }}
								{{ forms.config_input(source, values, 'weather_location') }}
								{{ forms.config_input(source, values, 'weather_key') }}
							</div>
							<div data-role="collapsible" data-theme="c" data-content-theme="a">
								<h3>{{ lang('configuration_page', 'phone', 'label') }}</h3>
								{{ forms.config_select(source, values, 'phone_service', dir('lib/phone/service', '(.+?).php') ) }}
								{{ forms.config_input(source, values, 'phone_server', 'wide') }}
								{{ forms.config_input(source, values, 'phone_port', 'wide') }}
								{{ forms.config_input(source, values, 'phone_user') }}
								{{ forms.config_input(source, values, 'phone_pass', 'password') }}
							</div>
							<div data-role="collapsible" data-theme="c" data-content-theme="a">
								<h3>{{ lang('configuration_page', 'calendar', 'label') }}</h3>
								{{ forms.config_select(source, values, 'calendar_service', dir('lib/calendar/service', '(.+?).php') ) }}
								{{ forms.config_input(source, values, 'calendar_url') }}
								{{ forms.config_input(source, values, 'calendar_username') }}
								{{ forms.config_input(source, values, 'calendar_password', 'password') }}
								{{ forms.config_input(source, values, 'calendar_name') }}
								{{ forms.config_input(source, values, 'calendar_color') }}
							</div>
						</div>
					</div>

					<div class="block">
						<div class="set-1" data-role="collapsible-set" data-content-theme="a" data-mini="true">
							<div class="ui-bar-c ui-corner-top ui-collapsible-caption">
								<h3 class="ui-collapsible-heading">{{ lang('configuration_page', 'internetaccess', 'label') }}</h3>
							</div>
							<div data-role="collapsible" data-collapsed="false" data-theme="c" data-content-theme="a" >
								<h3>{{ lang('configuration_page', 'proxy', 'label') }}</h3>
								{{ forms.config_flip(source, values, 'useproxy') }}
								{{ forms.config_input(source, values, 'proxy_url', 'wide') }}
								{{ forms.config_input(source, values, 'proxy_user') }}
								{{ forms.config_input(source, values, 'proxy_password', 'password') }}
							</div>
						</div>
					</div>

				</fieldset>

				<input type="hidden" id="current_pages" value="{{ config_pages }}" />
				<button type="submit" data-theme="b" data-icon="grid" name="submit" value="1">Save</button>
			</form>
		</div>
	{% endfor %}
</div>

{% endblock %}
