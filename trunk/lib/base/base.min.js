/* smartVISU, Martin Glei√ü, 2013, GPL [http://www.gnu.de] */
Number.prototype.limit=function(b,c,a){ret=this;ret<b&&(ret=b);ret>c&&(ret=c);a&&(ret=Math.floor(ret,a));return ret};String.prototype.explode=function(b){ret=[];if(this.length)for(ret=this.split(void 0!==b?b:","),b=0;b<ret.length;b++)ret[b]=ret[b].trim();return ret};
Date.prototype.duration=function(b){var c={y:307584E5,m:2592E6,w:6048E5,d:864E5,h:36E5,i:6E4,s:1E3},a=0;if(b){b=b.toLowerCase().split(" ");for(var d=0,e=1,e=-1,f=a=0;f<b.length;f+=1)if(Number(b[f]))d=b[f];else{if(e=b[f].match(/[a-z]/)){var g=e.index,e=b[f].substr(g);0<g&&(d=b[f].substr(0,g))}else e=b[f];e&&d&&(e=c[e],a+=d*e,d=0)}0==a&&0<d&&(a=d*c.s)}return new Date(a)};
(function(b){b.fn.extend({miniclock:function(){return this.each(function(){var c=b(this);c.displayMiniClock(c)})}});b.fn.displayMiniClock=function(c){var a=new Date;c.html(a.getHours()+":"+(10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes()));setTimeout(function(){b.fn.displayMiniClock(c)},b.fn.delay())};b.fn.delay=function(){return 1E3*(60-(new Date).getSeconds())}})(jQuery);
var fx={rotate:function(b,c,a){var d=b[0]-a[0],e=b[1]-a[1];b=Math.sqrt(d*d+e*e);d=Math.atan2(d,e)+c+0.5*Math.PI;c=Math.round(Math.cos(d)*b+a[0]);a=Math.round(Math.sin(d)*b+a[1]);return[c,a]},rotatepoint:function(b,c,a){c*=Math.PI/180;var d=Math.cos(c)*(b[0]-a[0])-Math.sin(c)*(b[1]-a[1])+a[0];b=Math.sin(c)*(b[0]-a[0])+Math.cos(c)*(b[1]-a[1])+a[1];return[d,b]},rotategrid:function(b,c){var a,d,e;c*=90/255;$("#"+b.id+" g").children().each(function(a){a=$(this);a.is("line")&&a.remove()});for(d=50;0<d;)a=
document.createElementNS("http://www.w3.org/2000/svg","line"),e=fx.rotatepoint([45,20+d],c,[50,20+d]),a.setAttributeNS(null,"x1",e[0]),a.setAttributeNS(null,"y1",e[1]),e=fx.rotatepoint([55,20+d],c,[50,20+d]),a.setAttributeNS(null,"x2",e[0]),a.setAttributeNS(null,"y2",e[1]),$("#"+b.id+" g").append(a),d-=10},rotategridz:function(b,c){var a,d;c=-1*90/255*c;$("#"+b.id+" g").children().each(function(a){a=$(this);a.is("line")&&a.remove()});d=0;a=document.createElementNS("http://www.w3.org/2000/svg","line");
a.setAttribute("class","light");a.setAttributeNS(null,"x1",50);a.setAttributeNS(null,"y1",10);a.setAttributeNS(null,"x2",50);a.setAttributeNS(null,"y2",20);$("#"+b.id+" g").append(a);a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("class","light");a.setAttributeNS(null,"x1",50);a.setAttributeNS(null,"y1",40);a.setAttributeNS(null,"x2",50);a.setAttributeNS(null,"y2",60);$("#"+b.id+" g").append(a);a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("class",
"light");a.setAttributeNS(null,"x1",50);a.setAttributeNS(null,"y1",80);a.setAttributeNS(null,"x2",50);a.setAttributeNS(null,"y2",90);for($("#"+b.id+" g").append(a);50>d;){a=document.createElementNS("http://www.w3.org/2000/svg","line");var e=fx.rotatepoint([25,30+d-5],c,[50,30+d]);a.setAttributeNS(null,"x1",e[0]);a.setAttributeNS(null,"y1",e[1]);e=fx.rotatepoint([45,30+d-5],c,[50,30+d]);a.setAttributeNS(null,"x2",e[0]);a.setAttributeNS(null,"y2",e[1]);$("#"+b.id+" g").append(a);a=document.createElementNS("http://www.w3.org/2000/svg",
"line");var f=fx.rotatepoint([75,30+d+5],c,[50,30+d]);a.setAttributeNS(null,"x1",f[0]);a.setAttributeNS(null,"y1",f[1]);f=fx.rotatepoint([55,30+d+5],c,[50,30+d]);a.setAttributeNS(null,"x2",f[0]);a.setAttributeNS(null,"y2",f[1]);$("#"+b.id+" g").append(a);a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttributeNS(null,"x1",e[0]);a.setAttributeNS(null,"y1",e[1]);a.setAttributeNS(null,"x2",f[0]);a.setAttributeNS(null,"y2",f[1]);$("#"+b.id+" g").append(a);d+=40}},grid:function(b,
c,a,d){var e;for($("#"+b.id+" g").children().each(function(a){a=$(this);a.is("line")&&a.remove()});0<c;)e=document.createElementNS("http://www.w3.org/2000/svg","line"),e.setAttributeNS(null,"x1",a[0]),e.setAttributeNS(null,"y1",a[1]<d[1]?a[1]+c:a[1]-c),e.setAttributeNS(null,"x2",d[0]),e.setAttributeNS(null,"y2",a[1]<d[1]?a[1]+c:a[1]-c),$("#"+b.id+" g").append(e),c-=6},hsv2rgb:function(b,c,a){var d,e,f;b=Math.max(0,Math.min(360,b));c=Math.max(0,Math.min(100,c));a=Math.max(0,Math.min(100,a));c/=100;
a/=100;if(0==c)d=c=a;else switch(b/=60,d=Math.floor(b),e=b-d,b=a*(1-c),f=a*(1-c*e),e=a*(1-c*(1-e)),d){case 0:d=a;c=e;a=b;break;case 1:d=f;c=a;a=b;break;case 2:d=b;c=a;a=e;break;case 3:d=b;c=f;break;case 4:d=e;c=b;break;default:d=a,c=b,a=f}d=Math.round(255*d);c=Math.round(255*c);a=Math.round(255*a);return"rgb("+d+","+c+","+a+")"}},notify={i:0,messages:{},exists:function(){var b=!1,c;for(c in notify.messages)b=!0;return b},add:function(b,c,a,d){notify.i++;notify.messages[notify.i]=[];notify.messages[notify.i]=
{status:b,signal:c,title:a,text:d,stamp:Date.now()}},debug:function(b,c){},update:function(b,c){notify.add("update","UPDATE",b,c);notify.display()},info:function(b,c){notify.add("info","INFO",b,c);notify.display()},error:function(b,c){notify.add("error","ERROR",b,c);notify.display()},json:function(b,c,a){b=jQuery.parseJSON(b.responseText);for(c=0;c<b.length;c++)notify.add("error","ERROR",b[c].title,b[c].text);notify.display()},remove:function(b){var c=notify.messages[notify.i];$(".alert").popup("close");
$(".signal").removeClass(c.status);$(".signal").hide();void 0!==b?delete notify.messages[b]:notify.messages={}},display:function(){var b=notify.messages[notify.i];b&&($(".signal").addClass(b.status),$(".signal").html(b.signal),$(".alert h1").html(b.title),$(".alert p").html(b.text),$(".alert .stamp").html((new Date(b.stamp)).transShort()),$(".signal").show())}}; 
