var io={adress:"",port:"",init:function(b,a){io.address=b;io.port=a},atmosphereRequest:null,read:function(b){$.ajax({url:"driver/io_openhab.php?cmd=getState&item="+b,type:"GET",dataType:"text",async:!0,cache:!1}).done(function(a){widget.update(b,a)})},write:function(b,a){io.put(b,a)},trigger:function(b,a){},run:function(b){io.RefreshAllItems();1==b&&(null!=io.atmosphereRequest&&($.atmosphere.subscribe(io.atmosphereRequest),io.atmosphereRequest=null),io.atmosphereRequest=new $.atmosphere.AtmosphereRequest,
io.atmosphereRequest.url="http://"+this.address+":"+this.port+"/rest/items?type=json",io.atmosphereRequest.contentType="application/json",io.atmosphereRequest.headers={Accept:"application/json",type:"json"},io.atmosphereRequest.transport="websocket",io.atmosphereRequest.fallbackTransport="long-polling",io.atmosphereRequest.onMessage=function(a){if("200"==a.status){a=obj=JSON.parse(a.responseBody);for(var b=widget.listeners(),c=0;c<widget.listeners().length;c++){var d=b[c];d==a.name&&widget.update(d,
a.state)}}},$.atmosphere.subscribe(io.atmosphereRequest))},RefreshAllItems:function(){if(widget.listeners().length)for(var b=widget.listeners(),a=0;a<widget.listeners().length;a++)io.read(b[a])},put:function(b,a){$.ajax({url:"driver/io_openhab.php?cmd=setState&item="+b+"&state="+a,type:"GET",async:!0,cache:!1,data:a}).done(function(a){widget.update(b,a)})}}; 
