/* smartVISU, Martin GleiÃŸ, 2012 - 2015, GPL [http://www.gnu.de] */
$(document).on("pagebeforeshow",function(n,g){1!=$.mobile.activePage.data("sv-events-bound")&&($.mobile.activePage.data("sv-events-bound",!0),$.mobile.activePage.find('a[data-widget="basic.button"]').on({click:function(b){""!=$(this).attr("data-val")&&io.write($(this).attr("data-item"),$(this).attr("data-val"))}}),$.mobile.activePage.find('input[data-widget="basic.checkbox"]').on({update:function(b,a){b.stopPropagation();$(this).prop("checked",0!=a).checkboxradio("refresh")},change:function(b){io.write($(this).attr("data-item"),
$(this).prop("checked")?1:0)}}),$.mobile.activePage.find('a[data-widget="basic.colordisc"]').on({update:function(b,a){b.stopPropagation();var c=$(this).attr("data-max");$("#"+this.id+" span").css("background-color","rgb("+Math.round(a[0]/c*255)+","+Math.round(a[1]/c*255)+","+Math.round(a[2]/c*255)+")")},click:function(b){$("#"+this.id+"-screen").removeClass("hide").addClass("in");var a=$(this).offset();b=$("#"+this.id+"-disc");var c=a.top-b.height()/2+15,a=a.left-b.width()/2+25;b.css("top",c.limit(5,
$(window).height()+$(document).scrollTop()-b.height()-5,1));b.css("left",a.limit(5,$(window).width()-b.width()-5,1));b.show()}}),$.mobile.activePage.find('div[data-widget="basic.colordisc"]').on({click:function(b){b=this.id.substr(0,this.id.length-7);$("#"+b+"-disc").hide();$("#"+b+"-screen").removeClass("in").addClass("hide")}}),$.mobile.activePage.find('canvas[data-widget="basic.colordisc"]').on({click:function(b){var a=this.id.substr(0,this.id.length-5),c=$(this)[0].getContext("2d"),d=$(this).offset();
b=c.getImageData(Math.round(b.pageX-d.left),Math.round(b.pageY-d.top),1,1).data;c=$("#"+a).attr("data-max");d=$("#"+a).attr("data-item").explode();io.write(d[0],Math.round(b[0]/255*c));io.write(d[1],Math.round(b[1]/255*c));io.write(d[2],Math.round(b[2]/255*c));$(this).hide();$("#"+a+"-screen").removeClass("in").addClass("hide")}}),$.mobile.activePage.find('a[data-widget="basic.dual"]').on({update:function(b,a){b.stopPropagation();$(this).val(a);$(this).trigger("draw")},draw:function(b){b.stopPropagation();
$(this).val()==$(this).attr("data-val-on")?($("#"+this.id+"-off").hide(),$("#"+this.id+"-on").show()):($("#"+this.id+"-on").hide(),$("#"+this.id+"-off").show())},click:function(b){io.write($(this).attr("data-item"),$(this).val()==$(this).attr("data-val-off")?$(this).attr("data-val-on"):$(this).attr("data-val-off"))}}),$.mobile.activePage.find('a[data-widget="basic.multistate"]').on({update:function(b,a){b.stopPropagation();list_val=$(this).attr("data-vals").explode();list_img=$(this).attr("data-img").explode();
idx=list_val.indexOf(a.toString());$("#"+this.id+" img").attr("src",list_img[idx]);$(this).attr("data-value",idx)},click:function(b){list_val=$(this).attr("data-vals").explode();old_idx=parseInt($(this).attr("data-value"));b=old_idx+1;b>=list_val.length&&(b=0);io.write($(this).attr("data-item"),list_val[b]);$(this).attr("data-value",b)}}),$.mobile.activePage.find('select[data-widget="basic.flip"]').on({update:function(b,a){b.stopPropagation();$(this).val(0<a?"on":"off").slider("refresh")},change:function(b){io.write($(this).attr("data-item"),
"on"==$(this).val()?1:0)}}),$.mobile.activePage.find('[data-widget="basic.float"]').on({update:function(b,a){b.stopPropagation();""!=$(this).attr("data-unit")?$("#"+this.id).html(parseFloat(a).transUnit($(this).attr("data-unit"))):$("#"+this.id).html(parseFloat(a).transFloat())}}),$.mobile.activePage.find('[data-widget="basic.formula"]').on({update:function(b,a){b.stopPropagation();var c=0,d=0,e=$(this).attr("data-unit"),f=$(this).attr("data-formula").substring(0,3),m=$(this).attr("data-formula");
if("date"==e||"time"==e||"short"==e||"long"==e)c=new Date(a[0]),$("#"+this.id).html(c.transUnit(e));else{if(-1<m.indexOf("VAR1")){for(d=0;d<a.length;d++)m=eval("formula.replace(/VAR"+(d+1)+"/g, response[i]);");c=eval(m)}else{"SUB"==f&&(c=a[d],d++);for(;d<a.length;d++)c="SUB"==f?c-a[d]:c+a[d];"AVG"==f&&(c/=d);""!=f&&(c=eval(m.replace(/VAR/g,c).replace(/AVG/g,"").replace(/SUM/g,"").replace(/SUB/g,"")))}$("#"+this.id).html(parseFloat(c).transUnit(e))}}}),$.mobile.activePage.find('a[data-widget="basic.rgb"]').on({update:function(b,
a){b.stopPropagation();var c=$(this).attr("data-max");$("#"+this.id+" span").css("background-color","rgb("+Math.round(a[0]/c*255)+","+Math.round(a[1]/c*255)+","+Math.round(a[2]/c*255)+")")}}),$.mobile.activePage.find('div[data-widget="basic.rgb-popup"] > div').on({click:function(b){b=$(this).css("background-color");b=b.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);var a=$(this).parent().attr("data-max"),c=$(this).parent().attr("data-item").explode();io.write(c[0],Math.round(b[1]/255*a));io.write(c[1],
Math.round(b[2]/255*a));io.write(c[2],Math.round(b[3]/255*a));$(this).parent().popup("close")},mouseenter:function(b){$(this).addClass("ui-focus")},mouseleave:function(b){$(this).removeClass("ui-focus")}}),$.mobile.activePage.find('span[data-widget="basic.shifter"]').on({update:function(b,a){b.stopPropagation();var c=Math.min(10*(a[0]/$(this).attr("data-max")*10+.49).toFixed(0),100);0!=a[1]&&0<c?$("#"+this.id+" img").attr("src",$(this).attr("data-pic-on").replace("00",c)):$("#"+this.id+" img").attr("src",
$(this).attr("data-pic-off"))},click:function(b){b=$(this).attr("data-item").explode();$("#"+this.id+" img").attr("src")==$(this).attr("data-pic-off")?io.write(b[1],1):io.write(b[1],0)}}),$(document).delegate('span[data-widget="basic.shifter"] > a > img',"hover",function(b){"mouseenter"===b.type?$(this).addClass("ui-focus"):$(this).removeClass("ui-focus")}),$.mobile.activePage.find('div[data-widget="basic.shutter"]').on({update:function(b,a){b.stopPropagation();var c=13,d="half"==$(this).attr("data-mode")?
.5:1;void 0!==a[1]&&(c=parseInt(13/d*(a[1]/$(this).attr("data-max")+d-1)));for(var e=parseInt(182*a[0]/$(this).attr("data-max")),f=12;1<=f;f--)if(14<=e){var m=13-Math.abs(c),d="height: "+(e>14*f&&13==c?14-m:15-m)+"px;",d=13!=c?d+("margin-top: "+(14<=e-15?m:parseInt(m/2))+"px;"):d+("border-top: 1px dotted "+(e>14*f?"#ccc":"#333")+";");0<c?$("#"+this.id+"-"+f).attr("class","blade-pos"):$("#"+this.id+"-"+f).attr("class","blade-neg");$("#"+this.id+"-"+f).attr("style",d);e-=15}else d="height: "+e+"px;",
d+="border-top: 1px dotted #aaa;",$("#"+this.id+"-"+f).attr("style",d),e=1},click:function(b){var a=$(this).offset(),c=Math.round(b.pageX-a.left);b=Math.floor(((b.pageY-a.top)/160-.0625)*$(this).attr("data-max")/$(this).attr("data-step"))*$(this).attr("data-step");b=b.limit($(this).attr("data-min"),$(this).attr("data-max"),1);a=$(this).attr("data-item").explode();""!=a[1]&&52<c?io.write(a[1],b):io.write(a[0],b)},mouseenter:function(b){$("#"+this.id+" .control").fadeIn(400)},mouseleave:function(b){$("#"+
this.id+" .control").fadeOut(400)}}),$.mobile.activePage.find('input[data-widget="basic.slider"]').on({update:function(b,a){b.stopPropagation();$(this).attr("lock",1);$("#"+this.id).val(a).slider("refresh").attr("mem",$(this).val())},slidestop:function(b){$(this).val()!=$(this).attr("mem")&&io.write($(this).attr("data-item"),$(this).val())},change:function(b){(void 0===$(this).attr("timer")||0==$(this).attr("timer")&&0==$(this).attr("lock"))&&$(this).val()!=$(this).attr("mem")&&(void 0!==$(this).attr("timer")&&
$(this).trigger("click"),$(this).attr("timer",1),setTimeout("$('#"+this.id+"').attr('timer', 0);",400));$(this).attr("lock",0)},click:function(b){io.write($(this).attr("data-item"),$(this).val())}}),$.mobile.activePage.find('span[data-widget="basic.switch"]').on({update:function(b,a){b.stopPropagation();$(this).val(a);$(this).trigger("draw")},draw:function(b){b.stopPropagation();$(this).val()==$(this).attr("data-val-on")?($("#"+this.id+"-off").hide(),$("#"+this.id+"-on").show()):($("#"+this.id+"-on").hide(),
$("#"+this.id+"-off").show())},click:function(b){io.write($(this).attr("data-item"),$(this).val()==$(this).attr("data-val-off")?$(this).attr("data-val-on"):$(this).attr("data-val-off"))}}),$.mobile.activePage.find('span[data-widget="basic.switch.v1"]').on({update:function(b,a){b.stopPropagation();$("#"+this.id+" img").attr("src",a==$(this).attr("data-val-on")?$(this).attr("data-pic-on"):$(this).attr("data-pic-off"))},click:function(b){$("#"+this.id+" img").attr("src")==$(this).attr("data-pic-off")?
io.write($(this).attr("data-item"),$(this).attr("data-val-on")):io.write($(this).attr("data-item"),$(this).attr("data-val-off"))}}),$.mobile.activePage.find('span[data-widget="basic.switch.v1"] > a > img',"hover").on(function(b,a){"mouseenter"===b.type?$(this).addClass("ui-focus"):$(this).removeClass("ui-focus")}),$.mobile.activePage.find('span[data-widget="basic.symbol"]').on({update:function(b,a){b.stopPropagation();var c="and"==$(this).attr("data-mode");if(a instanceof Array)for(var d=0;d<a.length;d++)c=
"and"==$(this).attr("data-mode")?c&&a[d]==$(this).attr("data-val"):c||a[d]==$(this).attr("data-val");else c=a==$(this).attr("data-val");$("#"+this.id+" img").attr("title",new Date);c?$("#"+this.id).show():$("#"+this.id).hide()}}),$.mobile.activePage.find('div[data-widget="basic.tank"]').on({update:function(b,a){b.stopPropagation();$("#"+this.id+" div").css("height",Math.round(180*Math.min(a/$(this).attr("data-max"),1)))}}),$.mobile.activePage.find('[data-widget="basic.text"]').on({update:function(b,
a){b.stopPropagation();$("#"+this.id).html(a==$(this).attr("data-val-on")?$(this).attr("data-txt-on"):$(this).attr("data-txt-off"))}}),$.mobile.activePage.find('a[data-widget="basic.trigger"]').on({click:function(b){io.trigger($(this).attr("data-name"),$(this).attr("data-val"))}}),$.mobile.activePage.find('[data-widget="basic.value"]').on({update:function(b,a){b.stopPropagation();var c=$(this).attr("data-unit");if("date"==c||"time"==c||"short"==c||"long"==c){var d=new Date(a);$("#"+this.id).html(d.transUnit(c))}else""!=
c&&$.isNumeric(a)?$("#"+this.id).html(parseFloat(a).transUnit(c)):$("#"+this.id).html(a)}}),$.mobile.activePage.find('span[data-widget="clock.iconclock"]').on({repeat:function(b){b.stopPropagation();b=Math.floor((new Date-(new Date).setHours(0,0,0,0))/1E3/60);$("#"+this.id+" svg").trigger("update",[[b],[0]])}}),$.mobile.activePage.find('span[data-widget="clock.miniclock"]').on({repeat:function(b){b.stopPropagation();b=new Date;$(".miniclock").html(b.getHours()+":"+(10>b.getMinutes()?"0"+b.getMinutes():
b.getMinutes()))}}),$.mobile.activePage.find('div[data-widget="device.codepad"]').on({keyup:function(b){13==b.keyCode&&$("#"+this.id+"-ok").click()},click:function(b){$(this).attr("data-access")||($(this).popup("open"),$(this).val("").focus())}}),$.mobile.activePage.find('div[data-widget="device.codepad"] > div > a').on({click:function(b){var a=$(this).parent().parent();b=$("#"+a.attr("id")+"-code");var c=$(this).attr("data-val");"ok"==c?a.attr("data-val")==b.val().md5()?($('div[data-bind="'+a.attr("data-id")+
'"]').attr("data-access",(new Date).getTime()).removeClass("codepad"),setTimeout(function(){$('div[data-bind="'+a.attr("data-id")+'"]').attr("data-access","").addClass("codepad")},(new Date).duration(a.attr("data-duration")).valueOf()),a.popup("close"),a.data("originally-clicked").trigger("click")):(b.val(""),$("#"+a.attr("id")).addClass("ui-focus"),setTimeout(function(){$("#"+a.attr("id")).removeClass("ui-focus")},400)):"-"==c?b.val(""):b.val(b.val()+c)}}),$.mobile.activePage.find('div[data-widget="device.rtr"] > div > a[data-icon="minus"]').on({click:function(b,
a){var c=$(this).parent().parent().attr("id"),d=$("#"+c).attr("data-step"),c=$("#"+c+"set").attr("data-item"),d=(Math.round(10*(widget.get(c)-d))/10).toFixed(1);io.write(c,d)}}),$.mobile.activePage.find('div[data-widget="device.rtr"] > div > a[data-icon="plus"]').on({click:function(b,a){var c=$(this).parent().parent().attr("id"),d=$("#"+c).attr("data-step"),c=$("#"+c+"set").attr("data-item"),d=(Math.round(10*(1*widget.get(c)+1*d))/10).toFixed(1);io.write(c,d)}}),$.mobile.activePage.find('div[data-widget="plot.comfortchart"]').on({update:function(b,
a){b.stopPropagation();var c=$(this).attr("data-label").explode(),d=$(this).attr("data-axis").explode(),e=[];e[0]={type:"area",name:c[0],lineWidth:0,data:[[17,35],[16,75],[17,85],[21,80],[25,60],[27,35],[25,19],[20,20],[17,35]]};e[1]={type:"area",name:c[1],lineWidth:0,data:[[17,75],[22.5,65],[25,33],[18.5,35],[17,75]]};e[2]={name:"point",data:[[1*a[0],1*a[1]]],marker:{enabled:!0,lineWidth:2,radius:6,symbol:"circle"},showInLegend:!1};$("#"+this.id).highcharts({series:e,xAxis:{min:10,max:35,title:{text:d[0],
align:"high",margin:-2}},yAxis:{min:0,max:100,title:{text:d[1],margin:7}},plotOptions:{area:{enableMouseTracking:!1}},tooltip:{formatter:function(){return this.x.transUnit("temp")+" / "+this.y.transUnit("%")}}})},point:function(b,a){b.stopPropagation();var c=$("#"+this.id).highcharts(),d=c.series[2].data[0];a[0]||(a[0]=d.x);a[1]||(a[1]=d.y);c.series[2].data[0].update([1*a[0],1*a[1]],!0)}}),$.mobile.activePage.find('div[data-widget="plot.multiaxis"]').on({update:function(b,a){b.stopPropagation();var c=
[];$(this).attr("data-ymin")&&(c=$(this).attr("data-ymin").explode());var d=[];$(this).attr("data-ymax")&&(d=$(this).attr("data-ymax").explode());var e=$(this).attr("data-label").explode(),f=$(this).attr("data-color").explode(),m=$(this).attr("data-exposure").explode(),g=$(this).attr("data-axis").explode(),l=$(this).attr("data-zoom"),p=[];$(this).attr("data-assign")&&(p=$(this).attr("data-assign").explode());var n=[];$(this).attr("data-opposite")&&(n=$(this).attr("data-opposite").explode());var r=
[];$(this).attr("data-ycolor")&&(r=$(this).attr("data-ycolor").explode());var t=[],q=[],k;for(k=0;k<a.length;k++)t[k]={type:"stair"!=m[k]?m[k]:"line",step:"stair"==m[k]?"left":!1,name:e[k],data:a[k],color:f[k]?f[k]:null,yAxis:p[k]?p[k]-1:0};for(k=0;k<g.length-1;k++)q[k]={min:c[k]?c[k]:null,max:d[k]?d[k]:null,title:{text:g[k+1]},opposite:0<n[k],minPadding:.05,maxPadding:.05,endOnTick:!1,startOnTick:!1},r[k]&&(q[k].lineColor=r[k],q[k].tickColor=r[k]);l?$("#"+this.id).highcharts({chart:{zoomType:"x"},
series:t,xAxis:{type:"datetime",title:{text:g[0]},minRange:(new Date).duration(l).valueOf()},yAxis:q}):$("#"+this.id).highcharts({series:t,xAxis:{type:"datetime",title:{text:g[0]}},yAxis:q})},point:function(b,a){b.stopPropagation();var c=$(this).attr("data-count");1>c&&(c=100);for(var d=0;d<a.length;d++)if(a[d]){for(var e=$("#"+this.id).highcharts(),f=0;f<a[d].length;f++)e.series[d].addPoint(a[d][f],!1,e.series[d].data.length>=c);e.redraw()}}}),$.mobile.activePage.find('div[data-widget="plot.period"]').on({update:function(b,
a){b.stopPropagation();for(var c=$(this).attr("data-label").explode(),d=$(this).attr("data-color").explode(),e=$(this).attr("data-exposure").explode(),f=$(this).attr("data-axis").explode(),g=$(this).attr("data-zoom"),h=[],l=0;l<a.length;l++)h[l]={type:"stair"!=e[l]?e[l]:"line",step:"stair"==e[l]?"left":!1,name:c[l],data:a[l],color:d[l]?d[l]:null};g?$("#"+this.id).highcharts({chart:{zoomType:"x"},series:h,xAxis:{type:"datetime",title:{text:f[0]},minRange:(new Date).duration(g).valueOf()},yAxis:{min:$(this).attr("data-ymin"),
max:$(this).attr("data-ymax"),title:{text:f[1]}}}):$("#"+this.id).highcharts({series:h,xAxis:{type:"datetime",title:{text:f[0]}},yAxis:{min:$(this).attr("data-ymin"),max:$(this).attr("data-ymax"),title:{text:f[1]}}})},point:function(b,a){b.stopPropagation();var c=$(this).attr("data-count");1>c&&(c=100);for(var d=0;d<a.length;d++)if(a[d]){for(var e=$("#"+this.id).highcharts(),f=0;f<a[d].length;f++)e.series[d].addPoint(a[d][f],!1,e.series[d].data.length>=c);e.redraw()}}}),$.mobile.activePage.find('div[data-widget="plot.rtr"]').on({update:function(b,
a){b.stopPropagation();for(var c=$(this).attr("data-label").explode(),d=$(this).attr("data-axis").explode(),e=a[2],f=e[0][0],g=0,h=1;h<e.length;h++)g+=e[h-1][1]*(e[h][0]-f),f=e[h][0];g/=f-e[0][0];1>g?g*=100:100<g&&(g=g/255*100);$("#"+this.id).highcharts({chart:{type:"line"},series:[{name:c[0],data:a[0],type:"spline"},{name:c[1],data:a[1],dashStyle:"shortdot",step:"left"},{type:"pie",name:"\u2211  On: ",data:[{name:"On",y:g},{name:"Off",y:100-g,color:null}],center:["95%","90%"],size:35,showInLegend:!1,
dataLabels:{enabled:!1}}],xAxis:{type:"datetime"},yAxis:{min:$(this).attr("data-min"),max:$(this).attr("data-max"),title:{text:d[1]}},tooltip:{formatter:function(){return this.series.name+" <b>"+(this.percentage?this.y.transUnit("%"):this.y.transUnit("temp"))+"</b>"}}})},point:function(b,a){b.stopPropagation();var c=$(this).attr("data-count");1>c&&(c=100);for(var d=0;d<a.length;d++){var e=$("#"+this.id).highcharts();if(a[d]&&(0==d||1==d))for(var f=0;f<a[d].length;f++)e.series[d].addPoint(a[d][f],
!1,e.series[d].data.length>=c);e.redraw()}}}),$.mobile.activePage.find('div[data-widget="plot.temprose"]').on({update:function(b,a){b.stopPropagation();var c=$(this).attr("data-label").explode(),d=$(this).attr("data-axis").explode(),e=parseInt($(this).attr("data-count")),f=[];f[0]={name:c[0],pointPlacement:"on",data:a.slice(0,e)};a.slice(e).length==e&&(f[1]={name:c[1],pointPlacement:"on",data:a.slice(e),dashStyle:"shortdot"});$("#"+this.id).highcharts({chart:{polar:!0,type:"line",marginLeft:10},series:f,
xAxis:{categories:d,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0},tooltip:{formatter:function(){return this.x+" - "+this.series.name+": <b>"+this.y.transUnit("temp")+"</b>"}},legend:{x:10,layout:"vertical"}})},point:function(b,a){b.stopPropagation();var c=$("#"+this.id).highcharts(),d=c.series[2].data[0];a[0]||(a[0]=d.x);a[1]||(a[1]=d.y);c.series[2].data[0].update([1*a[0],1*a[1]],!0)}}),$.mobile.activePage.find('div[data-widget="plot.minmaxavg"]').on({update:function(b,
a){b.stopPropagation();for(var c=$(this).attr("data-axis").explode(),d=$(this).attr("data-unit"),e=a[0],f=a[1],g=[],h=0;h<e.length;h++)g[h]=[e[h][0],e[h][1],f[h][1]];$("#"+this.id).highcharts({chart:{type:"columnrange",inverted:!1},series:[{data:g,enableMouseTracking:!1},{type:"line",data:a[2]}],xAxis:{type:"datetime",title:{text:c[0]}},yAxis:{min:$(this).attr("data-ymin"),max:$(this).attr("data-ymax"),title:{text:c[1]}},plotOptions:{columnrange:{dataLabels:{enabled:!0,formatter:function(){return""!=
d?parseFloat(this.y).transUnit(d):parseFloat(this.y).transFloat()}}}},tooltip:{pointFormatter:function(){var a;a=""!=d?parseFloat(this.y).transUnit(d):parseFloat(this.y).transFloat();return'<span style="color:'+this.color+'">\u00d8</span>  <b>'+a+"</b><br/>"}},legend:{enabled:!1}})},point:function(b,a){b.stopPropagation();var c=$(this).attr("data-count");1>c&&(c=100);for(var d=a[0],e=a[1],f=0;f<d.length;f++){var g=$("#"+this.id).highcharts();g.series[0].addPoint([d[f][0],d[f][1],e[f][1]],!1,g.series[f].data.length>=
c);g.series[1].addPoint(a[2][f],!1,g.series[f].data.length>=c);g.redraw()}}}),$.mobile.activePage.find('span[data-widget="status.collapse"]').on({update:function(b,a){b.stopPropagation();var c=$('div[data-bind="'+$(this).attr("data-id")+'"]');0!=a[0]?(c.not(".ui-collapsible").not(".ui-popup").show(),c.filter(".ui-collapsible").trigger("expand"),c.filter(".ui-popup").popup("open")):(c.not(".ui-collapsible").not(".ui-popup").hide(),c.filter(".ui-collapsible").trigger("collapse"),c.filter(".ui-popup").popup("close"))}}),
$.mobile.activePage.find('span[data-widget="status.log"]').on({update:function(b,a){b.stopPropagation();var c,d="";if(a[0]instanceof Array){for(var e=a[0].slice(0,$(this).attr("data-count")),f=0;f<e.length;f++)c='<div class="color '+e[f].level.toLowerCase()+'"></div>',c+="<h3>"+(new Date(e[f].time)).transLong()+"</h3>",c+="<p>"+e[f].message+"</p>",d+='<li data-icon="false">'+c+"</li>";$("#"+this.id+" ul").html(d).trigger("prepare").listview("refresh").trigger("redraw")}}}),$.mobile.activePage.find('span[data-widget="status.notify"]').on({update:function(b,
a){b.stopPropagation();0!=a[0]&&(notify.add($(this).attr("data-mode"),$(this).attr("data-signal"),$("#"+this.id+" h1").html(),"<b>"+a[1]+"</b><br  />"+$("#"+this.id+" p").html()),notify.display())}}),$.mobile.activePage.find('span[data-widget="status.message"]').on({update:function(b,a){b.stopPropagation();0!=a[0]?($("#"+this.id+"-message p span").html(a[1]?"<b>"+a[1]+"</b><br />":""),$("#"+this.id+"-message .stamp").html(a[2]?(new Date(a[2])).transShort():(new Date).transShort()),$("#"+this.id+"-message").popup("open")):
$("#"+this.id+"-message").popup("close")}}),$.mobile.activePage.find('svg[data-widget^="icon."]').on({update:function(b,a){b.stopPropagation();a instanceof Array&&this.setAttributeNS(null,"class","icon"+(a[0]&&a[1]?" icon1":" icon0"))},click:function(b){$(this).attr("data-item")&&(b=$(this).attr("data-item").explode(),b[1]&&io.write(b[1],0==widget.get(b[1])?1:0))}}),$.mobile.activePage.find('svg[data-widget="icon.arrow"]').on({update:function(b,a){b.stopPropagation();var c=a[0]/$(this).attr("data-max")*
2*Math.PI,d=[],d=d.concat([50,50],fx.rotate([25,50],c,[50,50]),fx.rotate([50,18],c,[50,50]),fx.rotate([75,50],c,[50,50]),[50,50]);$("#"+this.id+" #line0").attr("points",d.toString());d=[];d=d.concat(fx.rotate([32,50],c,[50,50]),fx.rotate([32,60],c,[50,50]),fx.rotate([68,60],c,[50,50]),fx.rotate([68,50],c,[50,50]));$("#"+this.id+" #line1").attr("points",d.toString())}}),$.mobile.activePage.find('svg[data-widget="icon.battery"]').on({update:function(b,a){b.stopPropagation();var c=6*Math.floor(a[0]/
$(this).attr("data-max")*40/6);fx.grid(this,c,[39,68],[61,28])}}),$.mobile.activePage.find('svg[data-widget="icon.blade"]').on({update:function(b,a){b.stopPropagation();for(var c=a[0]/$(this).attr("data-max")*.4*Math.PI,d,e=0;3>=e;e++)d=[],d=d.concat(fx.rotate([37,20+20*e],c,[50,20+20*e]),fx.rotate([63,20+20*e],c,[50,20+20*e])),$("#"+this.id+" #blade"+e).attr("points",d.toString())}}),$.mobile.activePage.find('svg[data-widget="icon.blade_z"]').on({update:function(b,a){b.stopPropagation();var c=a[0]/
$(this).attr("data-max")*.5*Math.PI*-1,d=[],d=d.concat(fx.rotate([25,25],c,[50,30]),fx.rotate([45,25],c,[50,30]),fx.rotate([55,35],c,[50,30]),fx.rotate([75,35],c,[50,30]));$("#"+this.id+" #blade0").attr("points",d.toString());d=[];d=d.concat(fx.rotate([25,65],c,[50,70]),fx.rotate([45,65],c,[50,70]),fx.rotate([55,75],c,[50,70]),fx.rotate([75,75],c,[50,70]));$("#"+this.id+" #blade1").attr("points",d.toString())}}),$.mobile.activePage.find('svg[data-widget="icon.blade_arc"]').on({update:function(b,a){b.stopPropagation();
var c=a[0]/$(this).attr("data-max")*-.7*Math.PI+.35*Math.PI,d;d="M "+fx.rotate([30,40],c,[50,37])+" Q "+fx.rotate([50,22],c,[50,30])+" "+fx.rotate([70,40],c,[50,37]);$("#"+this.id+" #blade0").attr("d",d);d="M "+fx.rotate([30,80],c,[50,77])+" Q "+fx.rotate([50,62],c,[50,70])+" "+fx.rotate([70,80],c,[50,77]);$("#"+this.id+" #blade1").attr("d",d)}}),$.mobile.activePage.find('svg[data-widget="icon.clock"]').on({update:function(b,a){b.stopPropagation();var c=a[0]%60/60*2*Math.PI;$("#"+this.id+" #hand_l").attr("points",
"50,50 "+fx.rotate([50,30],c,[50,50]).toString());c=5*Math.floor(a[0]/60)/60*2*Math.PI;$("#"+this.id+" #hand_s").attr("points","50,50 "+fx.rotate([50,35],c,[50,50]).toString())}}),$.mobile.activePage.find('svg[data-widget="icon.compass"]').on({update:function(b,a){b.stopPropagation();var c=a[0]/$(this).attr("data-max")*2*Math.PI,d=[],d=d.concat(fx.rotate([40,50],c,[50,50]),fx.rotate([50,25],c,[50,50]),fx.rotate([60,50],c,[50,50]));$("#"+this.id+" #pin0").attr("points",d.toString());d=[];d=d.concat(fx.rotate([40,
50],c,[50,50]),fx.rotate([50,75],c,[50,50]),fx.rotate([60,50],c,[50,50]));$("#"+this.id+" #pin1").attr("points",d.toString())}}),$.mobile.activePage.find('svg[data-widget="icon.graph"]').on({update:function(b,a){b.stopPropagation();var c=Math.round(a[0]/$(this).attr("data-max")*70),d=$("#"+this.id+" #graph").attr("d").substr(8),e=d.split("L");8<e.length&&e.shift();for(var d="M 15,85 ",f=1;f<e.length;f++)d+="L "+(10*f+5)+","+e[f].substr(e[f].indexOf(",")+1).trim()+" ";$("#"+this.id+" #graph").attr("d",
d+"L "+(10*f+5)+","+(85-c))}}),$.mobile.activePage.find('svg[data-widget="icon.light"]').on({update:function(b,a){var c=Math.round(a[0]/$(this).attr("data-max")*10),d=1;$("#"+this.id+" g#light-rays line").each(function(){$(this).css("visibility",c>=d?"visible":"hidden");d++})}}),$.mobile.activePage.find('svg[data-widget="icon.meter"]').on({update:function(b,a){b.stopPropagation();var c=a[0]/$(this).attr("data-max")*.44*Math.PI;$("#"+this.id+" #pointer").attr("points","50,85 "+fx.rotate([15,48],c,
[50,85]).toString())}}),$.mobile.activePage.find('svg[data-widget="icon.shutter"]').on({update:function(b,a){b.stopPropagation();var c=Math.round(a[0]/$(this).attr("data-max")*38);fx.grid(this,c,[14,30],[86,68])}}),$.mobile.activePage.find('svg[data-widget="icon.ventilation"]').on({update:function(b,a){b.stopPropagation();var c=4.5*(1-a[0]/$(this).attr("data-max"))+.5;$("#"+this.id+" #anim").attr("dur",0<a[0]?c:0)}}),$.mobile.activePage.find('svg[data-widget="icon.volume"]').on({update:function(b,
a){b.stopPropagation();var c=Math.round(a[0]/$(this).attr("data-max")*71);fx.bar(this,c,[18,68],[89,50])}}),$.mobile.activePage.find('svg[data-widget="icon.windmill"]').on({update:function(b,a){b.stopPropagation();var c=4.5*(1-a[0]/$(this).attr("data-max"))+.5;$("#"+this.id+" #anim1").attr("dur",0<a[0]?c:0)}}),$.mobile.activePage.find('svg[data-widget="icon.windrose"]').on({update:function(b,a){b.stopPropagation();var c=a[0]/$(this).attr("data-max")*2*Math.PI,d=[],d=d.concat(fx.rotate([50,60],c,[50,
50]),fx.rotate([37,71],c,[50,50]),fx.rotate([50,29],c,[50,50]));$("#"+this.id+" #pin0").attr("points",d.toString());d=[];d=d.concat(fx.rotate([50,60],c,[50,50]),fx.rotate([63,71],c,[50,50]),fx.rotate([50,29],c,[50,50]));$("#"+this.id+" #pin1").attr("points",d.toString())}}),$.mobile.activePage.find('svg[data-widget="icon.windsock"]').on({update:function(b,a){b.stopPropagation();var c=a[0]/$(this).attr("data-max")*.45*Math.PI,d=[],d=d.concat(fx.rotate([70,40],c,[80,22]),[80,22],fx.rotate([90,40],c,
[80,22]));$("#"+this.id+" #top").attr("points",d.toString());for(var e=0;3>e;e++)d=[],d=d.concat(fx.rotate([71+2*e,50+14*e],c,[80,22]),fx.rotate([89-2*e,50+14*e],c,[80,22]),fx.rotate([88-2*e,54+14*e],c,[80,22]),fx.rotate([72+2*e,54+14*e],c,[80,22])),$("#"+this.id+" #part"+e).attr("points",d.toString());d=[];d=d.concat(fx.rotate([70,40],c,[80,22]),fx.rotate([76,82],c,[80,22]),fx.rotate([84,82],c,[80,22]),fx.rotate([90,40],c,[80,22]));$("#"+this.id+" #part3").attr("points",d.toString())}}),$.mobile.activePage.find('svg[data-widget="icon.zenith"]').on({update:function(b,
a){b.stopPropagation();var c=a[0]/$(this).attr("data-max")*Math.PI;pt=fx.rotate([10,90],c,[50,90]);$("#"+this.id+" #sun").attr("x",pt[0]-50);$("#"+this.id+" #sun").attr("y",pt[1]-50)}}))});
$(document).delegate('canvas[data-widget="basic.colordisc"]',{init:function(n){n=parseFloat($(this).attr("data-colors"));var g=$(this)[0],b=100/($(this).attr("data-step")/2),a=Math.PI/(n+2)*2,c=-(Math.PI/2)+a,d=16.875/($(this).attr("data-step")/8),e=360/n;g.width=280;g.height=280;if(g.getContext){g=g.getContext("2d");g.beginPath();g.fillStyle="#888";g.shadowColor="rgba(96,96,96,0.4)";g.shadowOffsetX=2;g.shadowOffsetY=2;g.shadowBlur=4;g.arc(139,139,139,0,2*Math.PI,!1);g.fill();g.beginPath();g.shadowOffsetX=
0;g.shadowOffsetY=0;g.shadowBlur=0;g.fillStyle="#555";g.arc(139,139,138,0,2*Math.PI,!1);g.fill();for(var f,m=0;m<=n;m++){var h=c+m*a,l=1,p=m*e;for(f=b;100>=f;f+=b)g.beginPath(),g.fillStyle=fx.hsv2rgb(p,100,f),g.arc(139,139,l*d+d+1,h,h+a+.01,!1),g.arc(139,139,l*d,h+a+.01,h,!0),g.fill(),l+=1;for(f=100-b;f>=b;f-=b)g.beginPath(),g.fillStyle=fx.hsv2rgb(p,f,100),g.arc(139,139,l*d+d+1,h,h+a+.01,!1),g.arc(139,139,l*d,h+a+.01,h,!0),g.fill(),l+=1}--m;h=c+m*a;l=1;p=m*e;for(f=b;100>=f;f+=b/2)g.beginPath(),g.fillStyle=
fx.hsv2rgb(p,0,f),g.arc(139,139,l*d+d+1,h,h+2*a+.01,!1),g.arc(139,139,l*d,h+2*a+.01,h,!0),g.fill(),l+=1;g.beginPath();g.fillStyle="rgb(0,0,0)";g.arc(139,139,d+1,0,2*Math.PI,!1);g.fill()}}}); 
